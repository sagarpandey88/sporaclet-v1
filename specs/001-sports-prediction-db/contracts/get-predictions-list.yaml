openapi: 3.0.3
info:
  title: Sports Predictions API - List Predictions
  description: API endpoint for retrieving a paginated list of active sports predictions
  version: 1.0.0
  contact:
    name: Sporaclet API Team

servers:
  - url: http://localhost:3000/api/v1
    description: Local development server
  - url: https://api.sporaclet.com/api/v1
    description: Production server

paths:
  /predictions:
    get:
      summary: List active predictions
      description: |
        Retrieves a paginated list of predictions for upcoming sports events.
        Results are sorted by event scheduled date (soonest first).
        Only active (non-archived, non-deleted) predictions are returned.
      operationId: listPredictions
      tags:
        - Predictions
      parameters:
        - name: page
          in: query
          description: Page number (1-indexed)
          required: false
          schema:
            type: integer
            minimum: 1
            default: 1
            example: 1
        - name: limit
          in: query
          description: Number of predictions per page
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
            example: 20
        - name: sport_type
          in: query
          description: Filter by sport type (optional)
          required: false
          schema:
            type: string
            example: "Football"
      responses:
        '200':
          description: Successful response with prediction list
          headers:
            X-RateLimit-Limit:
              description: Request limit per time window
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              description: Remaining requests in current window
              schema:
                type: integer
                example: 95
            X-RateLimit-Reset:
              description: Unix timestamp when limit resets
              schema:
                type: integer
                example: 1641024000
          content:
            application/json:
              schema:
                type: object
                required:
                  - data
                  - pagination
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/PredictionListItem'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
              examples:
                success:
                  summary: Successful list response
                  value:
                    data:
                      - event_id: 1234
                        sport_type: "Football"
                        event_name: "Premier League: Arsenal vs Chelsea"
                        participants: "Arsenal FC vs Chelsea FC"
                        scheduled_at: "2026-01-15T20:00:00Z"
                        location: "Emirates Stadium, London"
                        prediction_id: 5678
                        predicted_outcome: "Arsenal wins 2-1"
                        confidence_score: 75.50
                      - event_id: 1235
                        sport_type: "Basketball"
                        event_name: "NBA: Lakers vs Warriors"
                        participants: "Los Angeles Lakers vs Golden State Warriors"
                        scheduled_at: "2026-01-16T02:00:00Z"
                        location: "Crypto.com Arena, Los Angeles"
                        prediction_id: 5679
                        predicted_outcome: "Lakers win by 5+ points"
                        confidence_score: 65.00
                    pagination:
                      total: 150
                      page: 1
                      limit: 20
                      total_pages: 8
                      has_next: true
                      has_previous: false
        '400':
          description: Bad request - invalid query parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                invalid_page:
                  summary: Invalid page parameter
                  value:
                    error:
                      code: "INVALID_PARAMETER"
                      message: "Page must be a positive integer"
                      details:
                        parameter: "page"
                        value: "-1"
        '429':
          description: Too many requests - rate limit exceeded
          headers:
            X-RateLimit-Limit:
              schema:
                type: integer
                example: 100
            X-RateLimit-Remaining:
              schema:
                type: integer
                example: 0
            X-RateLimit-Reset:
              schema:
                type: integer
                example: 1641024900
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                rate_limited:
                  summary: Rate limit exceeded
                  value:
                    error:
                      code: "RATE_LIMIT_EXCEEDED"
                      message: "Too many requests. Please try again later."
                      details:
                        limit: 100
                        window: "15 minutes"
                        reset_at: "2026-01-09T15:15:00Z"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
              examples:
                server_error:
                  summary: Internal error
                  value:
                    error:
                      code: "INTERNAL_ERROR"
                      message: "An unexpected error occurred. Please try again later."
                      details: {}

components:
  schemas:
    PredictionListItem:
      type: object
      required:
        - event_id
        - sport_type
        - event_name
        - participants
        - scheduled_at
        - prediction_id
        - predicted_outcome
        - confidence_score
      properties:
        event_id:
          type: integer
          format: int64
          description: Unique identifier for the event
          example: 1234
        sport_type:
          type: string
          description: Type of sport
          example: "Football"
        event_name:
          type: string
          description: Name/description of the event
          example: "Premier League: Arsenal vs Chelsea"
        participants:
          type: string
          description: Denormalized participant names (teams or players)
          example: "Arsenal FC vs Chelsea FC"
        scheduled_at:
          type: string
          format: date-time
          description: Event scheduled date and time (ISO 8601, UTC)
          example: "2026-01-15T20:00:00Z"
        location:
          type: string
          nullable: true
          description: Venue/location name
          example: "Emirates Stadium, London"
        prediction_id:
          type: integer
          format: int64
          description: Unique identifier for the prediction
          example: 5678
        predicted_outcome:
          type: string
          description: The predicted outcome text
          example: "Arsenal wins 2-1"
        confidence_score:
          type: number
          format: float
          minimum: 0
          maximum: 100
          description: Confidence level as percentage (0-100)
          example: 75.50

    Pagination:
      type: object
      required:
        - total
        - page
        - limit
        - total_pages
        - has_next
        - has_previous
      properties:
        total:
          type: integer
          description: Total number of items across all pages
          example: 150
        page:
          type: integer
          description: Current page number (1-indexed)
          example: 1
        limit:
          type: integer
          description: Number of items per page
          example: 20
        total_pages:
          type: integer
          description: Total number of pages
          example: 8
        has_next:
          type: boolean
          description: Whether there is a next page
          example: true
        has_previous:
          type: boolean
          description: Whether there is a previous page
          example: false

    Error:
      type: object
      required:
        - error
      properties:
        error:
          type: object
          required:
            - code
            - message
            - details
          properties:
            code:
              type: string
              description: Machine-readable error code
              example: "INVALID_PARAMETER"
            message:
              type: string
              description: Human-readable error message
              example: "Page must be a positive integer"
            details:
              type: object
              description: Additional error context
              example:
                parameter: "page"
                value: "-1"

tags:
  - name: Predictions
    description: Sports prediction operations
